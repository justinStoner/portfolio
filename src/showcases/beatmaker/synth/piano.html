<template>
  <require from="./components/piano-key"></require>
  <require from="../components/sound-wave"></require>
  <require from="../components/mute-button"></require>
  <require from="../components/knob"></require>
  <require from="./styles/synth.css"></require>
  <require from='./components/oscillator'></require>
  <require from="../effects/compressor"></require>
  <require from="../effects/delay"></require>
  <require from="../effects/equalizer"></require>
  <div class="mdl-grid">
    <div class="mdl-cell mdl-cell--3-col mdl-cell--12-col-phone mdl-cell--2-col-tablet">
      <oscillator type='Lfo' osc.two-way="synth.lfoData" preset.one-time="synth.lfoData"></oscillator>
    </div>
    <div class="mdl-cell mdl-cell--3-col mdl-cell--12-col-phone mdl-cell--2-col-tablet" repeat.for="osc of synth.oscillators">
      <oscillator osc.two-way="osc" index.bind="$index" type='Oscillator' preset.one-time="synth.oscPresets[$index]"></oscillator>
    </div>
    <div class="mdl-cell mdl-cell--6-col mdl-cell--12-col-phone mdl-cell--4-col-tablet">
      <div id="filter" class="mdl-shadow--2dp mdl-color--orange-300 b-radius-card">
        <div class="mdl-grid">
          <div class="mdl-cell mdl-cell--12-col">
            <p>Filter</p>
          </div>
          <div class="mdl-cell mdl-cell--3-col mdl-cell--2-col-phone mdl-cell--2-col-tablet">
            <knob min="0" max="200" label="Cutoff" preset.one-time="synth.lpfCutoff" channel='lpfCutoff'></knob>
          </div>
          <div class="mdl-cell mdl-cell--3-col mdl-cell--2-col-phone mdl-cell--2-col-tablet">
            <knob min="0" max="20" label="Q" channel='lpfQ' preset.one-time="synth.lpfQ"></knob>
          </div>
          <div class="mdl-cell mdl-cell--3-col mdl-cell--2-col-phone mdl-cell--2-col-tablet">
            <knob min="0" max="100" label="Mod" channel='lpfMod' preset.one-time="synth.lpfMod"></knob>
          </div>
          <div class="mdl-cell mdl-cell--3-col mdl-cell--2-col-phone mdl-cell--2-col-tablet">
            <knob min="0" max="100" label="Env" val.two-way="synth.lpfEnv" preset.one-time="synth.lpfEnv"></knob>
          </div>
          <div class="mdl-cell mdl-cell--12-col">
            <p>Envelope</p>
          </div>
          <div class="mdl-cell mdl-cell--3-col mdl-cell--2-col-phone mdl-cell--2-col-tablet">
            <knob min="0" max="100" label="Attack" val.two-way="synth.lpfA" preset.one-time="synth.lpfA"></knob>
          </div>
          <div class="mdl-cell mdl-cell--3-col mdl-cell--2-col-phone mdl-cell--2-col-tablet">
            <knob min="0" max="100" label="Decay" val.two-way="synth.lpfD" preset.one-time="synth.lpfD"></knob>
          </div>
          <div class="mdl-cell mdl-cell--3-col mdl-cell--2-col-phone mdl-cell--2-col-tablet">
            <knob min="0" max="100" label="Sustain" val.two-way="synth.lpfS" preset.one-time="lsynth.pfS"></knob>
          </div>
          <div class="mdl-cell mdl-cell--3-col mdl-cell--2-col-phone mdl-cell--2-col-tablet">
            <knob min="0" max="100" label="Release" val.two-way="synth.lpfR" preset.one-time="synth.lpfR"></knob>
          </div>
        </div>
      </div>
    </div>
    <div class="mdl-cell mdl-cell--6-col mdl-cell--12-col-phone mdl-cell--4-col-tablet" id="synth">
      <div id="synthfilter" class="mdl-shadow--2dp b-radius-card">
        <div class="mdl-grid">
          <div class="mdl-cell mdl-cell--12-col">
            <p>Synth</p>
          </div>
          <div class="mdl-cell mdl-cell--3-col mdl-cell--2-col-phone mdl-cell--2-col-tablet">
            <knob min="0" max="100" label="Drive" val.two-way="synth.lpfA" canvas.bind="true" preset.one-time="synth.lpfA"></knob>
          </div>
          <div class="mdl-cell mdl-cell--3-col mdl-cell--2-col-phone mdl-cell--2-col-tablet">
            <knob min="0" max="100" label="Reverb" val.two-way="synth.lpfD" canvas.bind="true" preset.one-time="synth.lpfA"></knob>
          </div>
          <div class="mdl-cell mdl-cell--3-col mdl-cell--2-col-phone mdl-cell--2-col-tablet">
            <knob id="soundwave" min="0" max="100" label="Volume" canvas.bind="true" channel='synthvol' preset.one-time="synth.masterVol"></knob>
          </div>
          <div class="mdl-cell mdl-cell--3-col mdl-cell--2-col-phone mdl-cell--2-col-tablet text-center" >
            <p style="margin-bottom:6px;">Visualizer</p>
            <button class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect ${ab.showVisualizer?'mdl-color-text--green-A400 mdl-color--white':'mdl-color--green-A400 mdl-color-text--white'}" click.trigger="ab.showVisualizer=!ab.showVisualizer" id='visualizer'>
              <i class="material-icons">graphic_eq</i>
            </button>
          </div>
          <div class="mdl-cell mdl-cell--12-col">
            <p>Envelope</p>
          </div>
          <div class="mdl-cell mdl-cell--3-col mdl-cell--2-col-phone mdl-cell--2-col-tablet">
            <knob min="0" max="100" label="Attack" canvas.bind="true" val.two-way="synth.envA" preset.one-time="synth.envA" ></knob>
          </div>
          <div class="mdl-cell mdl-cell--3-col mdl-cell--2-col-phone mdl-cell--2-col-tablet">
            <knob min="0" max="100" label="Decay" canvas.bind="true" val.two-way="synth.envD" preset.one-time="synth.envD"></knob>
          </div>
          <div class="mdl-cell mdl-cell--3-col mdl-cell--2-col-phone mdl-cell--2-col-tablet">
            <knob min="0" max="100" label="Sustain" canvas.bind="true" val.two-way="synth.envS" preset.one-time="synth.envS"></knob>
          </div>
          <div class="mdl-cell mdl-cell--3-col mdl-cell--2-col-phone mdl-cell--2-col-tablet">
            <knob min="0" max="100" label="Release" canvas.bind="true" val.two-way="synth.envR" preset.one-time="synth.envR"></knob>
          </div>
        </div>
      </div>
      <sound-wave ab.bind='ab' canvas-id='synthfilter' if.bind="ab.showVisualizer"></sound-wave>
    </div>
    <div class="mdl-cell mdl-cell--4-col mdl-cell--12-col-phone mdl-cell--3-col-tablet">
      <equalizer></equalizer>
    </div>
    <div class="mdl-cell mdl-cell--3-col mdl-cell--12-col-phone mdl-cell--2-col-tablet">
      <delay></delay>
    </div>
    <div class="mdl-cell mdl-cell--5-col mdl-cell--12-col-phone mdl-cell--3-col-tablet">
      <compressor></compressor>
    </div>
    <div class="mdl-cell mdl-cell--12-col">
      <piano-key class="${note.color?'white'+$index:'black'+$index}" repeat.for="note of synth.notes" playing.bind="note.isPlaying" index.bind="$index"  assigned.bind="note.assigned" key.bind="note" containerLess></piano-key>
    </div>
  </div>
</template>
